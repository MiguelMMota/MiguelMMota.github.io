---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout title="Blog">
  <h1>Blog</h1>
  <p style="color: var(--color-text-light); margin-top: 0.5rem;">
    Thoughts on Python, software engineering, and more.
  </p>

  <ul style="list-style: none; padding: 0; margin-top: 2rem;">
    {posts.map(post => (
      <li style="margin: 2rem 0; padding-bottom: 2rem; border-bottom: 1px solid var(--color-border);">
        <a href={`/blog/${post.slug}`} style="font-size: 1.25rem; font-weight: 500;">
          {post.data.title}
        </a>
        <div style="color: var(--color-text-light); font-size: 0.9rem; margin-top: 0.5rem;">
          {new Intl.DateTimeFormat('en-US', { year: 'numeric', month: 'long', day: 'numeric' }).format(post.data.date)}
        </div>
        {post.data.description && (
          <p style="margin-top: 0.75rem; color: var(--color-text-light);">
            {post.data.description}
          </p>
        )}
        {post.data.tags && post.data.tags.length > 0 && (
          <div style="margin-top: 0.75rem;">
            {post.data.tags.map(tag => (
              <span style="display: inline-block; background: var(--color-border); padding: 0.15rem 0.5rem; border-radius: 3px; font-size: 0.85rem; margin-right: 0.5rem;">
                {tag}
              </span>
            ))}
          </div>
        )}
      </li>
    ))}
  </ul>
</BaseLayout>
